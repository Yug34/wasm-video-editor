Excuse the extremely bad code, I'll refactor it later.